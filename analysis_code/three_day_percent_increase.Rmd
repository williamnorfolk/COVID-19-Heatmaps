---
title: "three_day_percent_increase"
author: "William Norfolk"
date: "3/26/2020"
output: html_document
---


```{r}
library(tidyverse)
library(readr)
library(maps)
library(usmap)
library(viridis)
```

```{r}
#Load masterdata
covid_master <- readRDS("../clean_covid_data.rds")
```

```{r}
total_pop <- readxl::read_excel("../us_pop.xlsx")
#saveRDS(total_pop, file = "../total_pop.rds")
```


## 5/20/20-5/23/20


```{r}
#To determine percent increase from prior day, include only last two observations
#MODIFY: object dates and variable dates.

only_20_and_23 <- subset(covid_master, select = c(Province_State, cases_5_20, cases_5_23, fips, total_pop))
```


```{r}
#add percent increase
#MODIFY: object dates and variable dates.

only_20_and_23 <- only_20_and_23 %>% dplyr::mutate(percent_increase = (cases_5_23 - cases_5_20) / cases_5_20 * 100)
```

```{r}
#make heatmap of percent increase

p_increase_cases_20_to_23 <- plot_usmap(data = only_20_and_23, values = "percent_increase", color = "black") + 
  
  scale_fill_continuous(low = "white", high = "red", name = "Percent Increase", label = scales::comma) + theme(legend.position = "right", plot.title = element_text(color = "black", size = 15, face = "bold"), plot.subtitle = element_text(color = "black", size = 10, face = "italic")) + labs(title = "Percent Increase of Confirmed COVID-19 Cases by State", subtitle = "From: 5/20/2020-5/23/2020")

p_increase_cases_20_to_23
```

```{r}
ggsave(filename = "../heat_maps/p_increase_cases_20_to_23.png", plot = p_increase_cases_20_to_23)
```


```{r}
#Take a look at the top 10 percent increases
#MODIFY: cases variable for new date
tail(sort(only_20_and_23$percent_increase ),10)
```

```{r}
#subset top 10 cases
#subset top 10 100K
#MODIFY: must search ten above individually (subset does not allow to select by these values for some reason...) and past the states in the code below.Also modify variable and object date names.

extp_1 <- subset(only_20_and_23, Province_State == "Iowa")
extp_2 <- subset(only_20_and_23, Province_State == "Virginia")
extp_3 <- subset(only_20_and_23, Province_State == "Mississippi")
extp_4 <- subset(only_20_and_23, Province_State == "West Virginia")
extp_5 <- subset(only_20_and_23, Province_State == "Maine")
extp_6 <- subset(only_20_and_23, Province_State == "Wisconsin")
extp_7 <- subset(only_20_and_23, Province_State == "Minnesota")
extp_8 <- subset(only_20_and_23, Province_State == "North Carolina")
extp_9 <- subset(only_20_and_23, Province_State == "North Dakota")
extp_10 <- subset(only_20_and_23, Province_State == "Arkansas")

top_ten_perc_increase <- rbind(extp_1, extp_2, extp_3, extp_4, extp_5, extp_6, extp_7, extp_8, extp_9, extp_10)
```

```{r}
#make bar chart
#Modify: object dates and variable dates

three_day_perc_increase_5_20_to_5_23_bar <- ggplot(top_ten_perc_increase, aes(x = reorder(Province_State, -percent_increase), percent_increase)) + geom_bar(aes(fill = reorder(Province_State, -percent_increase)), stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust = 1),
                                                                                                   legend.position = "none",                                                                        axis.text=element_text(size=12),                                                                 axis.title.y = element_text(size = 12),
  panel.border = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  axis.line = element_line(colour = "black"),
  panel.background = element_blank()) + xlab("") + ylab("Percent Increase") + ggtitle("COVID-19: Top Ten Percent Increase by State From 5/20/2020-5/23/2020") +
  
   geom_text(aes(label = round(percent_increase, 2)), size = 4, position = position_stack(vjust = 0.8))

three_day_perc_increase_5_20_to_5_23_bar
```

```{r}
ggsave(filename = "../bar_charts/three_day_perc_increase_5_20_to_5_23_bar.png", plot = three_day_perc_increase_5_20_to_5_23_bar)
```


## 5/21/20-5/24/20


```{r}
#To determine percent increase from prior day, include only last two observations
#MODIFY: object dates and variable dates.

only_21_and_24 <- subset(covid_master, select = c(Province_State, cases_5_21, cases_5_24, fips, total_pop))
```


```{r}
#add percent increase
#MODIFY: object dates and variable dates.

only_21_and_24 <- only_21_and_24 %>% dplyr::mutate(percent_increase = (cases_5_24 - cases_5_21) / cases_5_21 * 100)
```

```{r}
#make heatmap of percent increase

p_increase_cases_21_to_24 <- plot_usmap(data = only_21_and_24, values = "percent_increase", color = "black") + 
  
  scale_fill_continuous(low = "white", high = "red", name = "Percent Increase", label = scales::comma) + theme(legend.position = "right", plot.title = element_text(color = "black", size = 15, face = "bold"), plot.subtitle = element_text(color = "black", size = 10, face = "italic")) + labs(title = "Percent Increase of Confirmed COVID-19 Cases by State", subtitle = "From: 5/21/2020-5/24/2020")

p_increase_cases_21_to_24
```

```{r}
ggsave(filename = "../heat_maps/p_increase_cases_21_to_24.png", plot = p_increase_cases_21_to_24)
```


```{r}
#Take a look at the top 10 percent increases
#MODIFY: cases variable for new date
tail(sort(only_21_and_24$percent_increase ),10)
```

```{r}
#subset top 10 cases
#subset top 10 100K
#MODIFY: must search ten above individually (subset does not allow to select by these values for some reason...) and past the states in the code below.Also modify variable and object date names.

extp_1 <- subset(only_21_and_24, Province_State == "North Dakota")
extp_2 <- subset(only_21_and_24, Province_State == "Mississippi")
extp_3 <- subset(only_21_and_24, Province_State == "Arkansas")
extp_4 <- subset(only_21_and_24, Province_State == "Alabama")
extp_5 <- subset(only_21_and_24, Province_State == "South Dakota")
extp_6 <- subset(only_21_and_24, Province_State == "Maine")
extp_7 <- subset(only_21_and_24, Province_State == "Wisconsin")
extp_8 <- subset(only_21_and_24, Province_State == "West Virginia")
extp_9 <- subset(only_21_and_24, Province_State == "Minnesota")
extp_10 <- subset(only_21_and_24, Province_State == "North Carolina")

top_ten_perc_increase <- rbind(extp_1, extp_2, extp_3, extp_4, extp_5, extp_6, extp_7, extp_8, extp_9, extp_10)
```

```{r}
#make bar chart
#Modify: object dates and variable dates

three_day_perc_increase_5_21_to_5_24_bar <- ggplot(top_ten_perc_increase, aes(x = reorder(Province_State, -percent_increase), percent_increase)) + geom_bar(aes(fill = reorder(Province_State, -percent_increase)), stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust = 1),
                                                                                                   legend.position = "none",                                                                        axis.text=element_text(size=12),                                                                 axis.title.y = element_text(size = 12),
  panel.border = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  axis.line = element_line(colour = "black"),
  panel.background = element_blank()) + xlab("") + ylab("Percent Increase") + ggtitle("COVID-19: Top Ten Percent Increase by State From 5/21/2020-5/24/2020") +
  
   geom_text(aes(label = round(percent_increase, 2)), size = 4, position = position_stack(vjust = 0.8))

three_day_perc_increase_5_21_to_5_24_bar
```

```{r}
ggsave(filename = "../bar_charts/three_day_perc_increase_5_21_to_5_24_bar.png", plot = three_day_perc_increase_5_21_to_5_24_bar)
```


## 5/22/20-5/25/20


```{r}
#To determine percent increase from prior day, include only last two observations
#MODIFY: object dates and variable dates.

only_22_and_25 <- subset(covid_master, select = c(Province_State, cases_5_22, cases_5_25, fips, total_pop))
```


```{r}
#add percent increase
#MODIFY: object dates and variable dates.

only_22_and_25 <- only_22_and_25 %>% dplyr::mutate(percent_increase = (cases_5_25 - cases_5_22) / cases_5_22 * 100)
```

```{r}
#make heatmap of percent increase

p_increase_cases_22_to_25 <- plot_usmap(data = only_22_and_25, values = "percent_increase", color = "black") + 
  
  scale_fill_continuous(low = "white", high = "red", name = "Percent Increase", label = scales::comma) + theme(legend.position = "right", plot.title = element_text(color = "black", size = 15, face = "bold"), plot.subtitle = element_text(color = "black", size = 10, face = "italic")) + labs(title = "Percent Increase of Confirmed COVID-19 Cases by State", subtitle = "From: 5/22/2020-5/25/2020")

p_increase_cases_22_to_25
```

```{r}
ggsave(filename = "../heat_maps/p_increase_cases_22_to_25.png", plot = p_increase_cases_22_to_25)
```


```{r}
#Take a look at the top 10 percent increases
#MODIFY: cases variable for new date
tail(sort(only_22_and_25$percent_increase ),10)
```

```{r}
#subset top 10 cases
#subset top 10 100K
#MODIFY: must search ten above individually (subset does not allow to select by these values for some reason...) and past the states in the code below.Also modify variable and object date names.

extp_1 <- subset(only_22_and_25, Province_State == "Iowa")
extp_2 <- subset(only_22_and_25, Province_State == "Maine")
extp_3 <- subset(only_22_and_25, Province_State == "Mississippi")
extp_4 <- subset(only_22_and_25, Province_State == "California")
extp_5 <- subset(only_22_and_25, Province_State == "Arkansas")
extp_6 <- subset(only_22_and_25, Province_State == "Virginia")
extp_7 <- subset(only_22_and_25, Province_State == "Wisconsin")
extp_8 <- subset(only_22_and_25, Province_State == "North Carolina")
extp_9 <- subset(only_22_and_25, Province_State == "Alabama")
extp_10 <- subset(only_22_and_25, Province_State == "Minnesota")

top_ten_perc_increase <- rbind(extp_1, extp_2, extp_3, extp_4, extp_5, extp_6, extp_7, extp_8, extp_9, extp_10)
```

```{r}
#make bar chart
#Modify: object dates and variable dates

three_day_perc_increase_5_22_to_5_25_bar <- ggplot(top_ten_perc_increase, aes(x = reorder(Province_State, -percent_increase), percent_increase)) + geom_bar(aes(fill = reorder(Province_State, -percent_increase)), stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust = 1),
                                                                                                   legend.position = "none",                                                                        axis.text=element_text(size=12),                                                                 axis.title.y = element_text(size = 12),
  panel.border = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  axis.line = element_line(colour = "black"),
  panel.background = element_blank()) + xlab("") + ylab("Percent Increase") + ggtitle("COVID-19: Top Ten Percent Increase by State From 5/22/2020-5/25/2020") +
  
   geom_text(aes(label = round(percent_increase, 2)), size = 4, position = position_stack(vjust = 0.8))

three_day_perc_increase_5_22_to_5_25_bar
```

```{r}
ggsave(filename = "../bar_charts/three_day_perc_increase_5_22_to_5_25_bar.png", plot = three_day_perc_increase_5_22_to_5_25_bar)
```


## 5/23/20-5/26/20


```{r}
#To determine percent increase from prior day, include only last two observations
#MODIFY: object dates and variable dates.

only_23_and_26 <- subset(covid_master, select = c(Province_State, cases_5_23, cases_5_26, fips, total_pop))
```


```{r}
#add percent increase
#MODIFY: object dates and variable dates.

only_23_and_26 <- only_23_and_26 %>% dplyr::mutate(percent_increase = (cases_5_26 - cases_5_23) / cases_5_23 * 100)
```

```{r}
#make heatmap of percent increase

p_increase_cases_23_to_26 <- plot_usmap(data = only_23_and_26, values = "percent_increase", color = "black") + 
  
  scale_fill_continuous(low = "white", high = "red", name = "Percent Increase", label = scales::comma) + theme(legend.position = "right", plot.title = element_text(color = "black", size = 15, face = "bold"), plot.subtitle = element_text(color = "black", size = 10, face = "italic")) + labs(title = "Percent Increase of Confirmed COVID-19 Cases by State", subtitle = "From: 5/23/2020-5/26/2020")

p_increase_cases_23_to_26
```

```{r}
ggsave(filename = "../heat_maps/p_increase_cases_23_to_26.png", plot = p_increase_cases_23_to_26)
```


```{r}
#Take a look at the top 10 percent increases
#MODIFY: cases variable for new date
tail(sort(only_23_and_26$percent_increase ),10)
```

```{r}
#subset top 10 cases
#subset top 10 100K
#MODIFY: must search ten above individually (subset does not allow to select by these values for some reason...) and past the states in the code below.Also modify variable and object date names.

extp_1 <- subset(only_23_and_26, Province_State == "Delaware")
extp_2 <- subset(only_23_and_26, Province_State == "Wisconsin")
extp_3 <- subset(only_23_and_26, Province_State == "North Carolina")
extp_4 <- subset(only_23_and_26, Province_State == "Arkansas")
extp_5 <- subset(only_23_and_26, Province_State == "Nevada")
extp_6 <- subset(only_23_and_26, Province_State == "California")
extp_7 <- subset(only_23_and_26, Province_State == "New Mexico")
extp_8 <- subset(only_23_and_26, Province_State == "Virginia")
extp_9 <- subset(only_23_and_26, Province_State == "Minnesota")
extp_10 <- subset(only_23_and_26, Province_State == "Alabama")

top_ten_perc_increase <- rbind(extp_1, extp_2, extp_3, extp_4, extp_5, extp_6, extp_7, extp_8, extp_9, extp_10)
```

```{r}
#make bar chart
#Modify: object dates and variable dates

three_day_perc_increase_5_23_to_5_26_bar <- ggplot(top_ten_perc_increase, aes(x = reorder(Province_State, -percent_increase), percent_increase)) + geom_bar(aes(fill = reorder(Province_State, -percent_increase)), stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust = 1),
                                                                                                   legend.position = "none",                                                                        axis.text=element_text(size=12),                                                                 axis.title.y = element_text(size = 12),
  panel.border = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  axis.line = element_line(colour = "black"),
  panel.background = element_blank()) + xlab("") + ylab("Percent Increase") + ggtitle("COVID-19: Top Ten Percent Increase by State From 5/23/2020-5/26/2020") +
  
   geom_text(aes(label = round(percent_increase, 2)), size = 4, position = position_stack(vjust = 0.8))

three_day_perc_increase_5_23_to_5_26_bar
```

```{r}
ggsave(filename = "../bar_charts/three_day_perc_increase_5_23_to_5_26_bar.png", plot = three_day_perc_increase_5_23_to_5_26_bar)
```


## 5/24/20-5/27/20


```{r}
#To determine percent increase from prior day, include only last two observations
#MODIFY: object dates and variable dates.

only_24_and_27 <- subset(covid_master, select = c(Province_State, cases_5_24, cases_5_27, fips, total_pop))
```


```{r}
#add percent increase
#MODIFY: object dates and variable dates.

only_24_and_27 <- only_24_and_27 %>% dplyr::mutate(percent_increase = (cases_5_27 - cases_5_24) / cases_5_24 * 100)
```

```{r}
#make heatmap of percent increase

p_increase_cases_24_to_27 <- plot_usmap(data = only_24_and_27, values = "percent_increase", color = "black") + 
  
  scale_fill_continuous(low = "white", high = "red", name = "Percent Increase", label = scales::comma) + theme(legend.position = "right", plot.title = element_text(color = "black", size = 15, face = "bold"), plot.subtitle = element_text(color = "black", size = 10, face = "italic")) + labs(title = "Percent Increase of Confirmed COVID-19 Cases by State", subtitle = "From: 5/24/2020-5/27/2020")

p_increase_cases_24_to_27
```

```{r}
ggsave(filename = "../heat_maps/p_increase_cases_24_to_27.png", plot = p_increase_cases_24_to_27)
```


```{r}
#Take a look at the top 10 percent increases
#MODIFY: cases variable for new date
tail(sort(only_24_and_27$percent_increase ),10)
```

```{r}
#subset top 10 cases
#subset top 10 100K
#MODIFY: must search ten above individually (subset does not allow to select by these values for some reason...) and past the states in the code below.Also modify variable and object date names.

extp_1 <- subset(only_24_and_27, Province_State == "Arkansas")
extp_2 <- subset(only_24_and_27, Province_State == "Iowa")
extp_3 <- subset(only_24_and_27, Province_State == "North Carolina")
extp_4 <- subset(only_24_and_27, Province_State == "Nebraska")
extp_5 <- subset(only_24_and_27, Province_State == "California")
extp_6 <- subset(only_24_and_27, Province_State == "Wisconsin")
extp_7 <- subset(only_24_and_27, Province_State == "West Virginia")
extp_8 <- subset(only_24_and_27, Province_State == "Minnesota")
extp_9 <- subset(only_24_and_27, Province_State == "Alabama")
extp_10 <- subset(only_24_and_27, Province_State == "Virginia")

top_ten_perc_increase <- rbind(extp_1, extp_2, extp_3, extp_4, extp_5, extp_6, extp_7, extp_8, extp_9, extp_10)
```

```{r}
#make bar chart
#Modify: object dates and variable dates

three_day_perc_increase_5_24_to_5_27_bar <- ggplot(top_ten_perc_increase, aes(x = reorder(Province_State, -percent_increase), percent_increase)) + geom_bar(aes(fill = reorder(Province_State, -percent_increase)), stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust = 1),
                                                                                                   legend.position = "none",                                                                        axis.text=element_text(size=12),                                                                 axis.title.y = element_text(size = 12),
  panel.border = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  axis.line = element_line(colour = "black"),
  panel.background = element_blank()) + xlab("") + ylab("Percent Increase") + ggtitle("COVID-19: Top Ten Percent Increase by State From 5/24/2020-5/27/2020") +
  
   geom_text(aes(label = round(percent_increase, 2)), size = 4, position = position_stack(vjust = 0.8))

three_day_perc_increase_5_24_to_5_27_bar
```

```{r}
ggsave(filename = "../bar_charts/three_day_perc_increase_5_24_to_5_27_bar.png", plot = three_day_perc_increase_5_24_to_5_27_bar)
```


## 5/25/20-5/28/20


```{r}
#To determine percent increase from prior day, include only last two observations
#MODIFY: object dates and variable dates.

only_25_and_28 <- subset(covid_master, select = c(Province_State, cases_5_25, cases_5_28, fips, total_pop))
```


```{r}
#add percent increase
#MODIFY: object dates and variable dates.

only_25_and_28 <- only_25_and_28 %>% dplyr::mutate(percent_increase = (cases_5_28 - cases_5_25) / cases_5_25 * 100)
```

```{r}
#make heatmap of percent increase

p_increase_cases_25_to_28 <- plot_usmap(data = only_25_and_28, values = "percent_increase", color = "black") + 
  
  scale_fill_continuous(low = "white", high = "red", name = "Percent Increase", label = scales::comma) + theme(legend.position = "right", plot.title = element_text(color = "black", size = 15, face = "bold"), plot.subtitle = element_text(color = "black", size = 10, face = "italic")) + labs(title = "Percent Increase of Confirmed COVID-19 Cases by State", subtitle = "From: 5/25/2020-5/28/2020")

p_increase_cases_25_to_28
```

```{r}
ggsave(filename = "../heat_maps/p_increase_cases_25_to_28.png", plot = p_increase_cases_25_to_28)
```


```{r}
#Take a look at the top 10 percent increases
#MODIFY: cases variable for new date
tail(sort(only_25_and_28$percent_increase ),10)
```

```{r}
#subset top 10 cases
#subset top 10 100K
#MODIFY: must search ten above individually (subset does not allow to select by these values for some reason...) and past the states in the code below.Also modify variable and object date names.

extp_1 <- subset(only_25_and_28, Province_State == "Nebraska")
extp_2 <- subset(only_25_and_28, Province_State == "North Carolina")
extp_3 <- subset(only_25_and_28, Province_State == "Minnesota")
extp_4 <- subset(only_25_and_28, Province_State == "California")
extp_5 <- subset(only_25_and_28, Province_State == "Arizona")
extp_6 <- subset(only_25_and_28, Province_State == "Arkansas")
extp_7 <- subset(only_25_and_28, Province_State == "Wisconsin")
extp_8 <- subset(only_25_and_28, Province_State == "West Virginia")
extp_9 <- subset(only_25_and_28, Province_State == "Virginia")
extp_10 <- subset(only_25_and_28, Province_State == "Alabama")

top_ten_perc_increase <- rbind(extp_1, extp_2, extp_3, extp_4, extp_5, extp_6, extp_7, extp_8, extp_9, extp_10)
```

```{r}
#make bar chart
#Modify: object dates and variable dates

three_day_perc_increase_5_25_to_5_28_bar <- ggplot(top_ten_perc_increase, aes(x = reorder(Province_State, -percent_increase), percent_increase)) + geom_bar(aes(fill = reorder(Province_State, -percent_increase)), stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust = 1),
                                                                                                   legend.position = "none",                                                                        axis.text=element_text(size=12),                                                                 axis.title.y = element_text(size = 12),
  panel.border = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  axis.line = element_line(colour = "black"),
  panel.background = element_blank()) + xlab("") + ylab("Percent Increase") + ggtitle("COVID-19: Top Ten Percent Increase by State From 5/25/2020-5/28/2020") +
  
   geom_text(aes(label = round(percent_increase, 2)), size = 4, position = position_stack(vjust = 0.8))

three_day_perc_increase_5_25_to_5_28_bar
```

```{r}
ggsave(filename = "../bar_charts/three_day_perc_increase_5_25_to_5_28_bar.png", plot = three_day_perc_increase_5_25_to_5_28_bar)
```

## 5/26/20-5/29/20


```{r}
#To determine percent increase from prior day, include only last two observations
#MODIFY: object dates and variable dates.

only_26_and_29 <- subset(covid_master, select = c(Province_State, cases_5_26, cases_5_29, fips, total_pop))
```


```{r}
#add percent increase
#MODIFY: object dates and variable dates.

only_26_and_29 <- only_26_and_29 %>% dplyr::mutate(percent_increase = (cases_5_29 - cases_5_26) / cases_5_26 * 100)
```

```{r}
#make heatmap of percent increase

p_increase_cases_26_to_29 <- plot_usmap(data = only_26_and_29, values = "percent_increase", color = "black") + 
  
  scale_fill_continuous(low = "white", high = "red", name = "Percent Increase", label = scales::comma) + theme(legend.position = "right", plot.title = element_text(color = "black", size = 15, face = "bold"), plot.subtitle = element_text(color = "black", size = 10, face = "italic")) + labs(title = "Percent Increase of Confirmed COVID-19 Cases by State", subtitle = "From: 5/26/2020-5/29/2020")

p_increase_cases_26_to_29
```

```{r}
ggsave(filename = "../heat_maps/p_increase_cases_26_to_29.png", plot = p_increase_cases_26_to_29)
```


```{r}
#Take a look at the top 10 percent increases
#MODIFY: cases variable for new date
tail(sort(only_26_and_29$percent_increase ),10)
```

```{r}
#subset top 10 cases
#subset top 10 100K
#MODIFY: must search ten above individually (subset does not allow to select by these values for some reason...) and past the states in the code below.Also modify variable and object date names.

extp_1 <- subset(only_26_and_29, Province_State == "Utah")
extp_2 <- subset(only_26_and_29, Province_State == "Mississippi")
extp_3 <- subset(only_26_and_29, Province_State == "Virginia")
extp_4 <- subset(only_26_and_29, Province_State == "Nebraska")
extp_5 <- subset(only_26_and_29, Province_State == "Alabama")
extp_6 <- subset(only_26_and_29, Province_State == "Arizona")
extp_7 <- subset(only_26_and_29, Province_State == "Arkansas")
extp_8 <- subset(only_26_and_29, Province_State == "North Carolina")
extp_9 <- subset(only_26_and_29, Province_State == "West Virginia")
extp_10 <- subset(only_26_and_29, Province_State == "Wisconsin")

top_ten_perc_increase <- rbind(extp_1, extp_2, extp_3, extp_4, extp_5, extp_6, extp_7, extp_8, extp_9, extp_10)
```

```{r}
#make bar chart
#Modify: object dates and variable dates

three_day_perc_increase_5_26_to_5_29_bar <- ggplot(top_ten_perc_increase, aes(x = reorder(Province_State, -percent_increase), percent_increase)) + geom_bar(aes(fill = reorder(Province_State, -percent_increase)), stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust = 1),
                                                                                                   legend.position = "none",                                                                        axis.text=element_text(size=12),                                                                 axis.title.y = element_text(size = 12),
  panel.border = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  axis.line = element_line(colour = "black"),
  panel.background = element_blank()) + xlab("") + ylab("Percent Increase") + ggtitle("COVID-19: Top Ten Percent Increase by State From 5/26/2020-5/29/2020") +
  
   geom_text(aes(label = round(percent_increase, 2)), size = 4, position = position_stack(vjust = 0.8))

three_day_perc_increase_5_26_to_5_29_bar
```

```{r}
ggsave(filename = "../bar_charts/three_day_perc_increase_5_26_to_5_29_bar.png", plot = three_day_perc_increase_5_26_to_5_29_bar)
```

## 5/27/20-5/30/20


```{r}
#To determine percent increase from prior day, include only last two observations
#MODIFY: object dates and variable dates.

only_27_and_30 <- subset(covid_master, select = c(Province_State, cases_5_27, cases_5_30, fips, total_pop))
```


```{r}
#add percent increase
#MODIFY: object dates and variable dates.

only_27_and_30 <- only_27_and_30 %>% dplyr::mutate(percent_increase = (cases_5_30 - cases_5_27) / cases_5_27 * 100)
```

```{r}
#make heatmap of percent increase

p_increase_cases_27_to_30 <- plot_usmap(data = only_27_and_30, values = "percent_increase", color = "black") + 
  
  scale_fill_continuous(low = "white", high = "red", name = "Percent Increase", label = scales::comma) + theme(legend.position = "right", plot.title = element_text(color = "black", size = 15, face = "bold"), plot.subtitle = element_text(color = "black", size = 10, face = "italic")) + labs(title = "Percent Increase of Confirmed COVID-19 Cases by State", subtitle = "From: 5/27/2020-5/30/2020")

p_increase_cases_27_to_30
```

```{r}
ggsave(filename = "../heat_maps/p_increase_cases_27_to_30.png", plot = p_increase_cases_27_to_30)
```


```{r}
#Take a look at the top 10 percent increases
#MODIFY: cases variable for new date
tail(sort(only_27_and_30$percent_increase ),10)
```

```{r}
#subset top 10 cases
#subset top 10 100K
#MODIFY: must search ten above individually (subset does not allow to select by these values for some reason...) and past the states in the code below.Also modify variable and object date names.

extp_1 <- subset(only_27_and_30, Province_State == "Minnesota")
extp_2 <- subset(only_27_and_30, Province_State == "Alabama")
extp_3 <- subset(only_27_and_30, Province_State == "Virginia")
extp_4 <- subset(only_27_and_30, Province_State == "Mississippi")
extp_5 <- subset(only_27_and_30, Province_State == "California")
extp_6 <- subset(only_27_and_30, Province_State == "Utah")
extp_7 <- subset(only_27_and_30, Province_State == "Wisconsin")
extp_8 <- subset(only_27_and_30, Province_State == "Arizona")
extp_9 <- subset(only_27_and_30, Province_State == "North Carolina")
extp_10 <- subset(only_27_and_30, Province_State == "Arkansas")

top_ten_perc_increase <- rbind(extp_1, extp_2, extp_3, extp_4, extp_5, extp_6, extp_7, extp_8, extp_9, extp_10)
```

```{r}
#make bar chart
#Modify: object dates and variable dates

three_day_perc_increase_5_27_to_5_30_bar <- ggplot(top_ten_perc_increase, aes(x = reorder(Province_State, -percent_increase), percent_increase)) + geom_bar(aes(fill = reorder(Province_State, -percent_increase)), stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust = 1),
                                                                                                   legend.position = "none",                                                                        axis.text=element_text(size=12),                                                                 axis.title.y = element_text(size = 12),
  panel.border = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  axis.line = element_line(colour = "black"),
  panel.background = element_blank()) + xlab("") + ylab("Percent Increase") + ggtitle("COVID-19: Top Ten Percent Increase by State From 5/27/2020-5/30/2020") +
  
   geom_text(aes(label = round(percent_increase, 2)), size = 4, position = position_stack(vjust = 0.8))

three_day_perc_increase_5_27_to_5_30_bar
```

```{r}
ggsave(filename = "../bar_charts/three_day_perc_increase_5_27_to_5_30_bar.png", plot = three_day_perc_increase_5_27_to_5_30_bar)
```


## 5/28/20-5/31/20


```{r}
#To determine percent increase from prior day, include only last two observations
#MODIFY: object dates and variable dates.

only_28_and_31 <- subset(covid_master, select = c(Province_State, cases_5_28, cases_5_31, fips, total_pop))
```


```{r}
#add percent increase
#MODIFY: object dates and variable dates.

only_28_and_31 <- only_28_and_31 %>% dplyr::mutate(percent_increase = (cases_5_31 - cases_5_28) / cases_5_28 * 100)
```

```{r}
#make heatmap of percent increase

p_increase_cases_28_to_31 <- plot_usmap(data = only_28_and_31, values = "percent_increase", color = "black") + 
  
  scale_fill_continuous(low = "white", high = "red", name = "Percent Increase", label = scales::comma) + theme(legend.position = "right", plot.title = element_text(color = "black", size = 15, face = "bold"), plot.subtitle = element_text(color = "black", size = 10, face = "italic")) + labs(title = "Percent Increase of Confirmed COVID-19 Cases by State", subtitle = "From: 5/28/2020-5/31/2020")

p_increase_cases_28_to_31
```

```{r}
ggsave(filename = "../heat_maps/p_increase_cases_28_to_31.png", plot = p_increase_cases_28_to_31)
```


```{r}
#Take a look at the top 10 percent increases
#MODIFY: cases variable for new date
tail(sort(only_28_and_31$percent_increase ),10)
```

```{r}
#subset top 10 cases
#subset top 10 100K
#MODIFY: must search ten above individually (subset does not allow to select by these values for some reason...) and past the states in the code below.Also modify variable and object date names.

extp_1 <- subset(only_28_and_31, Province_State == "Mississippi")
extp_2 <- subset(only_28_and_31, Province_State == "Minnesota")
extp_3 <- subset(only_28_and_31, Province_State == "Alaska")
extp_4 <- subset(only_28_and_31, Province_State == "Wisconsin")
extp_5 <- subset(only_28_and_31, Province_State == "Alabama")
extp_6 <- subset(only_28_and_31, Province_State == "South Carolina")
extp_7 <- subset(only_28_and_31, Province_State == "Utah")
extp_8 <- subset(only_28_and_31, Province_State == "Arkansas")
extp_9 <- subset(only_28_and_31, Province_State == "Arizona")
extp_10 <- subset(only_28_and_31, Province_State == "North Carolina")

top_ten_perc_increase <- rbind(extp_1, extp_2, extp_3, extp_4, extp_5, extp_6, extp_7, extp_8, extp_9, extp_10)
```

```{r}
#make bar chart
#Modify: object dates and variable dates

three_day_perc_increase_5_28_to_5_31_bar <- ggplot(top_ten_perc_increase, aes(x = reorder(Province_State, -percent_increase), percent_increase)) + geom_bar(aes(fill = reorder(Province_State, -percent_increase)), stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust = 1),
                                                                                                   legend.position = "none",                                                                        axis.text=element_text(size=12),                                                                 axis.title.y = element_text(size = 12),
  panel.border = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  axis.line = element_line(colour = "black"),
  panel.background = element_blank()) + xlab("") + ylab("Percent Increase") + ggtitle("COVID-19: Top Ten Percent Increase by State From 5/28/2020-5/31/2020") +
  
   geom_text(aes(label = round(percent_increase, 2)), size = 4, position = position_stack(vjust = 0.8))

three_day_perc_increase_5_28_to_5_31_bar
```

```{r}
ggsave(filename = "../bar_charts/three_day_perc_increase_5_28_to_5_31_bar.png", plot = three_day_perc_increase_5_28_to_5_31_bar)
```


## 5/29/20-6/01/20


```{r}
#To determine percent increase from prior day, include only last two observations
#MODIFY: object dates and variable dates.

only_29_and_1 <- subset(covid_master, select = c(Province_State, cases_5_29, cases_6_1, fips, total_pop))
```


```{r}
#add percent increase
#MODIFY: object dates and variable dates.

only_29_and_1 <- only_29_and_1 %>% dplyr::mutate(percent_increase = (cases_6_1 - cases_5_29) / cases_5_29 * 100)
```

```{r}
#make heatmap of percent increase

p_increase_cases_29_to_1 <- plot_usmap(data = only_29_and_1, values = "percent_increase", color = "black") + 
  
  scale_fill_continuous(low = "white", high = "red", name = "Percent Increase", label = scales::comma) + theme(legend.position = "right", plot.title = element_text(color = "black", size = 15, face = "bold"), plot.subtitle = element_text(color = "black", size = 10, face = "italic")) + labs(title = "Percent Increase of Confirmed COVID-19 Cases by State", subtitle = "From: 5/29/2020-6/1/2020")

p_increase_cases_29_to_1
```

```{r}
ggsave(filename = "../heat_maps/p_increase_cases_29_to_1.png", plot = p_increase_cases_29_to_1)
```


```{r}
#Take a look at the top 10 percent increases
#MODIFY: cases variable for new date
tail(sort(only_29_and_1$percent_increase ),10)
```

```{r}
#subset top 10 cases
#subset top 10 100K
#MODIFY: must search ten above individually (subset does not allow to select by these values for some reason...) and past the states in the code below.Also modify variable and object date names.

extp_1 <- subset(only_29_and_1, Province_State == "California")
extp_2 <- subset(only_29_and_1, Province_State == "Texas")
extp_3 <- subset(only_29_and_1, Province_State == "Utah")
extp_4 <- subset(only_29_and_1, Province_State == "Alaska")
extp_5 <- subset(only_29_and_1, Province_State == "Arizona")
extp_6 <- subset(only_29_and_1, Province_State == "Oklahoma")
extp_7 <- subset(only_29_and_1, Province_State == "South Carolina")
extp_8 <- subset(only_29_and_1, Province_State == "Alabama")
extp_9 <- subset(only_29_and_1, Province_State == "Arkansas")
extp_10 <- subset(only_29_and_1, Province_State == "North Carolina")

top_ten_perc_increase <- rbind(extp_1, extp_2, extp_3, extp_4, extp_5, extp_6, extp_7, extp_8, extp_9, extp_10)
```

```{r}
#make bar chart
#Modify: object dates and variable dates

three_day_perc_increase_5_29_to_6_1_bar <- ggplot(top_ten_perc_increase, aes(x = reorder(Province_State, -percent_increase), percent_increase)) + geom_bar(aes(fill = reorder(Province_State, -percent_increase)), stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust = 1),
                                                                                                   legend.position = "none",                                                                        axis.text=element_text(size=12),                                                                 axis.title.y = element_text(size = 12),
  panel.border = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  axis.line = element_line(colour = "black"),
  panel.background = element_blank()) + xlab("") + ylab("Percent Increase") + ggtitle("COVID-19: Top Ten Percent Increase by State From 5/29/2020-6/1/2020") +
  
   geom_text(aes(label = round(percent_increase, 2)), size = 4, position = position_stack(vjust = 0.8))

three_day_perc_increase_5_29_to_6_1_bar
```

```{r}
ggsave(filename = "../bar_charts/three_day_perc_increase_5_29_to_6_1_bar.png", plot = three_day_perc_increase_5_29_to_6_1_bar)
```


## 5/30/20-6/02/20


```{r}
#To determine percent increase from prior day, include only last two observations
#MODIFY: object dates and variable dates.

only_30_and_2 <- subset(covid_master, select = c(Province_State, cases_5_30, cases_6_2, fips, total_pop))
```


```{r}
#add percent increase
#MODIFY: object dates and variable dates.

only_30_and_2 <- only_30_and_2 %>% dplyr::mutate(percent_increase = (cases_6_2 - cases_5_30) / cases_5_30 * 100)
```

```{r}
#make heatmap of percent increase

p_increase_cases_30_to_2 <- plot_usmap(data = only_30_and_2, values = "percent_increase", color = "black") + 
  
  scale_fill_continuous(low = "white", high = "red", name = "Percent Increase", label = scales::comma) + theme(legend.position = "right", plot.title = element_text(color = "black", size = 15, face = "bold"), plot.subtitle = element_text(color = "black", size = 10, face = "italic")) + labs(title = "Percent Increase of Confirmed COVID-19 Cases by State", subtitle = "From: 5/30/2020-6/2/2020")

p_increase_cases_30_to_2
```

```{r}
ggsave(filename = "../heat_maps/p_increase_cases_30_to_2.png", plot = p_increase_cases_30_to_2)
```


```{r}
#Take a look at the top 10 percent increases
#MODIFY: cases variable for new date
tail(sort(only_30_and_2$percent_increase ),10)
```

```{r}
#subset top 10 cases
#subset top 10 100K
#MODIFY: must search ten above individually (subset does not allow to select by these values for some reason...) and past the states in the code below.Also modify variable and object date names.

extp_1 <- subset(only_30_and_2, Province_State == "Utah")
extp_2 <- subset(only_30_and_2, Province_State == "Texas")
extp_3 <- subset(only_30_and_2, Province_State == "Oklahoma")
extp_4 <- subset(only_30_and_2, Province_State == "Tennessee")
extp_5 <- subset(only_30_and_2, Province_State == "North Carolina")
extp_6 <- subset(only_30_and_2, Province_State == "Alabama")
extp_7 <- subset(only_30_and_2, Province_State == "South Carolina")
extp_8 <- subset(only_30_and_2, Province_State == "Arizona")
extp_9 <- subset(only_30_and_2, Province_State == "Arkansas")
extp_10 <- subset(only_30_and_2, Province_State == "Alaska")

top_ten_perc_increase <- rbind(extp_1, extp_2, extp_3, extp_4, extp_5, extp_6, extp_7, extp_8, extp_9, extp_10)
```

```{r}
#make bar chart
#Modify: object dates and variable dates

three_day_perc_increase_5_30_to_6_2_bar <- ggplot(top_ten_perc_increase, aes(x = reorder(Province_State, -percent_increase), percent_increase)) + geom_bar(aes(fill = reorder(Province_State, -percent_increase)), stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust = 1),
                                                                                                   legend.position = "none",                                                                        axis.text=element_text(size=12),                                                                 axis.title.y = element_text(size = 12),
  panel.border = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  axis.line = element_line(colour = "black"),
  panel.background = element_blank()) + xlab("") + ylab("Percent Increase") + ggtitle("COVID-19: Top Ten Percent Increase by State From 5/30/2020-6/2/2020") +
  
   geom_text(aes(label = round(percent_increase, 2)), size = 4, position = position_stack(vjust = 0.8))

three_day_perc_increase_5_30_to_6_2_bar
```

```{r}
ggsave(filename = "../bar_charts/three_day_perc_increase_5_30_to_6_2_bar.png", plot = three_day_perc_increase_5_30_to_6_2_bar)
```


## 5/31/20-6/03/20


```{r}
#To determine percent increase from prior day, include only last two observations
#MODIFY: object dates and variable dates.

only_31_and_3 <- subset(covid_master, select = c(Province_State, cases_5_31, cases_6_3, fips, total_pop))
```


```{r}
#add percent increase
#MODIFY: object dates and variable dates.

only_31_and_3 <- only_31_and_3 %>% dplyr::mutate(percent_increase = (cases_6_3 - cases_5_31) / cases_5_31 * 100)
```

```{r}
#make heatmap of percent increase

p_increase_cases_31_to_3 <- plot_usmap(data = only_31_and_3, values = "percent_increase", color = "black") + 
  
  scale_fill_continuous(low = "white", high = "red", name = "Percent Increase", label = scales::comma) + theme(legend.position = "right", plot.title = element_text(color = "black", size = 15, face = "bold"), plot.subtitle = element_text(color = "black", size = 10, face = "italic")) + labs(title = "Percent Increase of Confirmed COVID-19 Cases by State", subtitle = "From: 5/31/2020-6/3/2020")

p_increase_cases_31_to_3
```

```{r}
ggsave(filename = "../heat_maps/p_increase_cases_31_to_3.png", plot = p_increase_cases_31_to_3)
```


```{r}
#Take a look at the top 10 percent increases
#MODIFY: cases variable for new date
tail(sort(only_31_and_3$percent_increase ),10)
```

```{r}
#subset top 10 cases
#subset top 10 100K
#MODIFY: must search ten above individually (subset does not allow to select by these values for some reason...) and past the states in the code below.Also modify variable and object date names.

extp_1 <- subset(only_31_and_3, Province_State == "Oklahoma")
extp_2 <- subset(only_31_and_3, Province_State == "Texas")
extp_3 <- subset(only_31_and_3, Province_State == "California")
extp_4 <- subset(only_31_and_3, Province_State == "Utah")
extp_5 <- subset(only_31_and_3, Province_State == "Kentucky")
extp_6 <- subset(only_31_and_3, Province_State == "North Carolina")
extp_7 <- subset(only_31_and_3, Province_State == "Alaska")
extp_8 <- subset(only_31_and_3, Province_State == "Tennessee")
extp_9 <- subset(only_31_and_3, Province_State == "Arkansas")
extp_10 <- subset(only_31_and_3, Province_State == "Arizona")

top_ten_perc_increase <- rbind(extp_1, extp_2, extp_3, extp_4, extp_5, extp_6, extp_7, extp_8, extp_9, extp_10)
```

```{r}
#make bar chart
#Modify: object dates and variable dates

three_day_perc_increase_5_31_to_6_3_bar <- ggplot(top_ten_perc_increase, aes(x = reorder(Province_State, -percent_increase), percent_increase)) + geom_bar(aes(fill = reorder(Province_State, -percent_increase)), stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust = 1),
                                                                                                   legend.position = "none",                                                                        axis.text=element_text(size=12),                                                                 axis.title.y = element_text(size = 12),
  panel.border = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  axis.line = element_line(colour = "black"),
  panel.background = element_blank()) + xlab("") + ylab("Percent Increase") + ggtitle("COVID-19: Top Ten Percent Increase by State From 5/31/2020-6/3/2020") +
  
   geom_text(aes(label = round(percent_increase, 2)), size = 4, position = position_stack(vjust = 0.8))

three_day_perc_increase_5_31_to_6_3_bar
```

```{r}
ggsave(filename = "../bar_charts/three_day_perc_increase_5_31_to_6_3_bar.png", plot = three_day_perc_increase_5_31_to_6_3_bar)
```

## 6/1/20-6/04/20


```{r}
#To determine percent increase from prior day, include only last two observations
#MODIFY: object dates and variable dates.

only_1_and_4 <- subset(covid_master, select = c(Province_State, cases_6_1, cases_6_4, fips, total_pop))
```


```{r}
#add percent increase
#MODIFY: object dates and variable dates.

only_1_and_4 <- only_1_and_4 %>% dplyr::mutate(percent_increase = (cases_6_4 - cases_6_1) / cases_6_1 * 100)
```

```{r}
#make heatmap of percent increase

p_increase_cases_1_to_4 <- plot_usmap(data = only_1_and_4, values = "percent_increase", color = "black") + 
  
  scale_fill_continuous(low = "white", high = "red", name = "Percent Increase", label = scales::comma) + theme(legend.position = "right", plot.title = element_text(color = "black", size = 15, face = "bold"), plot.subtitle = element_text(color = "black", size = 10, face = "italic")) + labs(title = "Percent Increase of Confirmed COVID-19 Cases by State", subtitle = "From: 6/1/2020-6/4/2020")

p_increase_cases_1_to_4
```

```{r}
ggsave(filename = "../heat_maps/p_increase_cases_1_to_4.png", plot = p_increase_cases_1_to_4)
```


```{r}
#Take a look at the top 10 percent increases
#MODIFY: cases variable for new date
tail(sort(only_1_and_4$percent_increase ),10)
```

```{r}
#subset top 10 cases
#subset top 10 100K
#MODIFY: must search ten above individually (subset does not allow to select by these values for some reason...) and past the states in the code below.Also modify variable and object date names.

extp_1 <- subset(only_1_and_4, Province_State == "Kentucky")
extp_2 <- subset(only_1_and_4, Province_State == "New Mexico")
extp_3 <- subset(only_1_and_4, Province_State == "Wisconsin")
extp_4 <- subset(only_1_and_4, Province_State == "Texas")
extp_5 <- subset(only_1_and_4, Province_State == "Utah")
extp_6 <- subset(only_1_and_4, Province_State == "North Carolina")
extp_7 <- subset(only_1_and_4, Province_State == "Alaska")
extp_8 <- subset(only_1_and_4, Province_State == "Tennessee")
extp_9 <- subset(only_1_and_4, Province_State == "Arkansas")
extp_10 <- subset(only_1_and_4, Province_State == "Arizona")

top_ten_perc_increase <- rbind(extp_1, extp_2, extp_3, extp_4, extp_5, extp_6, extp_7, extp_8, extp_9, extp_10)
```

```{r}
#make bar chart
#Modify: object dates and variable dates

three_day_perc_increase_6_1_to_6_4_bar <- ggplot(top_ten_perc_increase, aes(x = reorder(Province_State, -percent_increase), percent_increase)) + geom_bar(aes(fill = reorder(Province_State, -percent_increase)), stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust = 1),
                                                                                                   legend.position = "none",                                                                        axis.text=element_text(size=12),                                                                 axis.title.y = element_text(size = 12),
  panel.border = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  axis.line = element_line(colour = "black"),
  panel.background = element_blank()) + xlab("") + ylab("Percent Increase") + ggtitle("COVID-19: Top Ten Percent Increase by State From 6/1/2020-6/4/2020") +
  
   geom_text(aes(label = round(percent_increase, 2)), size = 4, position = position_stack(vjust = 0.8))

three_day_perc_increase_6_1_to_6_4_bar
```

```{r}
ggsave(filename = "../bar_charts/three_day_perc_increase_6_1_to_6_4_bar.png", plot = three_day_perc_increase_6_1_to_6_4_bar)
```

## 6/2/20-6/05/20


```{r}
#To determine percent increase from prior day, include only last two observations
#MODIFY: object dates and variable dates.

only_2_and_5 <- subset(covid_master, select = c(Province_State, cases_6_2, cases_6_5, fips, total_pop))
```


```{r}
#add percent increase
#MODIFY: object dates and variable dates.

only_2_and_5 <- only_2_and_5 %>% dplyr::mutate(percent_increase = (cases_6_5 - cases_6_2) / cases_6_2 * 100)
```

```{r}
#make heatmap of percent increase

p_increase_cases_2_to_5 <- plot_usmap(data = only_2_and_5, values = "percent_increase", color = "black") + 
  
  scale_fill_continuous(low = "white", high = "red", name = "Percent Increase", label = scales::comma) + theme(legend.position = "right", plot.title = element_text(color = "black", size = 15, face = "bold"), plot.subtitle = element_text(color = "black", size = 10, face = "italic")) + labs(title = "Percent Increase of Confirmed COVID-19 Cases by State", subtitle = "From: 6/2/2020-6/5/2020")

p_increase_cases_2_to_5
```

```{r}
ggsave(filename = "../heat_maps/p_increase_cases_2_to_5.png", plot = p_increase_cases_2_to_5)
```


```{r}
#Take a look at the top 10 percent increases
#MODIFY: cases variable for new date
tail(sort(only_2_and_5$percent_increase ),10)
```

```{r}
#subset top 10 cases
#subset top 10 100K
#MODIFY: must search ten above individually (subset does not allow to select by these values for some reason...) and past the states in the code below.Also modify variable and object date names.

extp_1 <- subset(only_2_and_5, Province_State == "California")
extp_2 <- subset(only_2_and_5, Province_State == "Alaska")
extp_3 <- subset(only_2_and_5, Province_State == "Kentucky")
extp_4 <- subset(only_2_and_5, Province_State == "Texas")
extp_5 <- subset(only_2_and_5, Province_State == "New Mexico")
extp_6 <- subset(only_2_and_5, Province_State == "South Carolina")
extp_7 <- subset(only_2_and_5, Province_State == "Utah")
extp_8 <- subset(only_2_and_5, Province_State == "Arkansas")
extp_9 <- subset(only_2_and_5, Province_State == "North Carolina")
extp_10 <- subset(only_2_and_5, Province_State == "Arizona")

top_ten_perc_increase <- rbind(extp_1, extp_2, extp_3, extp_4, extp_5, extp_6, extp_7, extp_8, extp_9, extp_10)
```

```{r}
#make bar chart
#Modify: object dates and variable dates

three_day_perc_increase_6_2_to_6_5_bar <- ggplot(top_ten_perc_increase, aes(x = reorder(Province_State, -percent_increase), percent_increase)) + geom_bar(aes(fill = reorder(Province_State, -percent_increase)), stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust = 1),
                                                                                                   legend.position = "none",                                                                        axis.text=element_text(size=12),                                                                 axis.title.y = element_text(size = 12),
  panel.border = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  axis.line = element_line(colour = "black"),
  panel.background = element_blank()) + xlab("") + ylab("Percent Increase") + ggtitle("COVID-19: Top Ten Percent Increase by State From 6/2/2020-6/5/2020") +
  
   geom_text(aes(label = round(percent_increase, 2)), size = 4, position = position_stack(vjust = 0.8))

three_day_perc_increase_6_2_to_6_5_bar
```

```{r}
ggsave(filename = "../bar_charts/three_day_perc_increase_6_2_to_6_5_bar.png", plot = three_day_perc_increase_6_2_to_6_5_bar)
```


## 6/3/20-6/06/20


```{r}
#To determine percent increase from prior day, include only last two observations
#MODIFY: object dates and variable dates.

only_3_and_6 <- subset(covid_master, select = c(Province_State, cases_6_3, cases_6_6, fips, total_pop))
```


```{r}
#add percent increase
#MODIFY: object dates and variable dates.

only_3_and_6 <- only_3_and_6 %>% dplyr::mutate(percent_increase = (cases_6_6 - cases_6_3) / cases_6_3 * 100)
```

```{r}
#make heatmap of percent increase

p_increase_cases_3_to_6 <- plot_usmap(data = only_3_and_6, values = "percent_increase", color = "black") + 
  
  scale_fill_continuous(low = "white", high = "red", name = "Percent Increase", label = scales::comma) + theme(legend.position = "right", plot.title = element_text(color = "black", size = 15, face = "bold"), plot.subtitle = element_text(color = "black", size = 10, face = "italic")) + labs(title = "Percent Increase of Confirmed COVID-19 Cases by State", subtitle = "From: 6/3/2020-6/6/2020")

p_increase_cases_3_to_6
```

```{r}
ggsave(filename = "../heat_maps/p_increase_cases_3_to_6.png", plot = p_increase_cases_3_to_6)
```


```{r}
#Take a look at the top 10 percent increases
#MODIFY: cases variable for new date
tail(sort(only_3_and_6$percent_increase ),10)
```

```{r}
#subset top 10 cases
#subset top 10 100K
#MODIFY: must search ten above individually (subset does not allow to select by these values for some reason...) and past the states in the code below.Also modify variable and object date names.

extp_1 <- subset(only_3_and_6, Province_State == "Idaho")
extp_2 <- subset(only_3_and_6, Province_State == "California")
extp_3 <- subset(only_3_and_6, Province_State == "New Mexico")
extp_4 <- subset(only_3_and_6, Province_State == "Texas")
extp_5 <- subset(only_3_and_6, Province_State == "South Carolina")
extp_6 <- subset(only_3_and_6, Province_State == "Kentucky")
extp_7 <- subset(only_3_and_6, Province_State == "North Carolina")
extp_8 <- subset(only_3_and_6, Province_State == "Utah")
extp_9 <- subset(only_3_and_6, Province_State == "Arkansas")
extp_10 <- subset(only_3_and_6, Province_State == "Arizona")

top_ten_perc_increase <- rbind(extp_1, extp_2, extp_3, extp_4, extp_5, extp_6, extp_7, extp_8, extp_9, extp_10)
```

```{r}
#make bar chart
#Modify: object dates and variable dates

three_day_perc_increase_6_3_to_6_6_bar <- ggplot(top_ten_perc_increase, aes(x = reorder(Province_State, -percent_increase), percent_increase)) + geom_bar(aes(fill = reorder(Province_State, -percent_increase)), stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust = 1),
                                                                                                   legend.position = "none",                                                                        axis.text=element_text(size=12),                                                                 axis.title.y = element_text(size = 12),
  panel.border = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  axis.line = element_line(colour = "black"),
  panel.background = element_blank()) + xlab("") + ylab("Percent Increase") + ggtitle("COVID-19: Top Ten Percent Increase by State From 6/3/2020-6/6/2020") +
  
   geom_text(aes(label = round(percent_increase, 2)), size = 4, position = position_stack(vjust = 0.8))

three_day_perc_increase_6_3_to_6_6_bar
```

```{r}
ggsave(filename = "../bar_charts/three_day_perc_increase_6_3_to_6_6_bar.png", plot = three_day_perc_increase_6_3_to_6_6_bar)
```

## 6/5/20-6/08/20


```{r}
#To determine percent increase from prior day, include only last two observations
#MODIFY: object dates and variable dates.

only_5_and_8 <- subset(covid_master, select = c(Province_State, cases_6_5, cases_6_8, fips, total_pop))
```


```{r}
#add percent increase
#MODIFY: object dates and variable dates.

only_5_and_8 <- only_5_and_8 %>% dplyr::mutate(percent_increase = (cases_6_8 - cases_6_5) / cases_6_5 * 100)
```

```{r}
#make heatmap of percent increase

p_increase_cases_5_to_8 <- plot_usmap(data = only_5_and_8, values = "percent_increase", color = "black") + 
  
  scale_fill_continuous(low = "white", high = "red", name = "Percent Increase", label = scales::comma) + theme(legend.position = "right", plot.title = element_text(color = "black", size = 15, face = "bold"), plot.subtitle = element_text(color = "black", size = 10, face = "italic")) + labs(title = "Percent Increase of Confirmed COVID-19 Cases by State", subtitle = "From: 6/5/2020-6/8/2020")

p_increase_cases_5_to_8
```

```{r}
ggsave(filename = "../heat_maps/p_increase_cases_5_to_8.png", plot = p_increase_cases_5_to_8)
```


```{r}
#Take a look at the top 10 percent increases
#MODIFY: cases variable for new date
tail(sort(only_5_and_8$percent_increase ),10)
```

```{r}
#subset top 10 cases
#subset top 10 100K
#MODIFY: must search ten above individually (subset does not allow to select by these values for some reason...) and past the states in the code below.Also modify variable and object date names.

extp_1 <- subset(only_5_and_8, Province_State == "California")
extp_2 <- subset(only_5_and_8, Province_State == "Alaska")
extp_3 <- subset(only_5_and_8, Province_State == "Oregon")
extp_4 <- subset(only_5_and_8, Province_State == "Alabama")
extp_5 <- subset(only_5_and_8, Province_State == "Utah")
extp_6 <- subset(only_5_and_8, Province_State == "North Carolina")
extp_7 <- subset(only_5_and_8, Province_State == "South Carolina")
extp_8 <- subset(only_5_and_8, Province_State == "Michigan")
extp_9 <- subset(only_5_and_8, Province_State == "Arkansas")
extp_10 <- subset(only_5_and_8, Province_State == "Arizona")

top_ten_perc_increase <- rbind(extp_1, extp_2, extp_3, extp_4, extp_5, extp_6, extp_7, extp_8, extp_9, extp_10)
```

```{r}
#make bar chart
#Modify: object dates and variable dates

three_day_perc_increase_6_5_to_6_8_bar <- ggplot(top_ten_perc_increase, aes(x = reorder(Province_State, -percent_increase), percent_increase)) + geom_bar(aes(fill = reorder(Province_State, -percent_increase)), stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust = 1),
                                                                                                   legend.position = "none",                                                                        axis.text=element_text(size=12),                                                                 axis.title.y = element_text(size = 12),
  panel.border = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  axis.line = element_line(colour = "black"),
  panel.background = element_blank()) + xlab("") + ylab("Percent Increase") + ggtitle("COVID-19: Top Ten Percent Increase by State From 6/5/2020-6/8/2020") +
  
   geom_text(aes(label = round(percent_increase, 2)), size = 4, position = position_stack(vjust = 0.8))

three_day_perc_increase_6_5_to_6_8_bar
```

```{r}
ggsave(filename = "../bar_charts/three_day_perc_increase_6_5_to_6_8_bar.png", plot = three_day_perc_increase_6_5_to_6_8_bar)
```

## 6/6/20-6/09/20


```{r}
#To determine percent increase from prior day, include only last two observations
#MODIFY: object dates and variable dates.

only_6_and_9 <- subset(covid_master, select = c(Province_State, cases_6_6, cases_6_9, fips, total_pop))
```


```{r}
#add percent increase
#MODIFY: object dates and variable dates.

only_6_and_9 <- only_6_and_9 %>% dplyr::mutate(percent_increase = (cases_6_9 - cases_6_6) / cases_6_6 * 100)
```

```{r}
#make heatmap of percent increase

p_increase_cases_6_to_9 <- plot_usmap(data = only_6_and_9, values = "percent_increase", color = "black") + 
  
  scale_fill_continuous(low = "white", high = "red", name = "Percent Increase", label = scales::comma) + theme(legend.position = "right", plot.title = element_text(color = "black", size = 15, face = "bold"), plot.subtitle = element_text(color = "black", size = 10, face = "italic")) + labs(title = "Percent Increase of Confirmed COVID-19 Cases by State", subtitle = "From: 6/6/2020-6/9/2020")

p_increase_cases_6_to_9
```

```{r}
ggsave(filename = "../heat_maps/p_increase_cases_6_to_9.png", plot = p_increase_cases_6_to_9)
```


```{r}
#Take a look at the top 10 percent increases
#MODIFY: cases variable for new date
tail(sort(only_6_and_9$percent_increase ),10)
```

```{r}
#subset top 10 cases
#subset top 10 100K
#MODIFY: must search ten above individually (subset does not allow to select by these values for some reason...) and past the states in the code below.Also modify variable and object date names.

extp_1 <- subset(only_6_and_9, Province_State == "Mississippi")
extp_2 <- subset(only_6_and_9, Province_State == "Utah")
extp_3 <- subset(only_6_and_9, Province_State == "Alabama")
extp_4 <- subset(only_6_and_9, Province_State == "Alaska")
extp_5 <- subset(only_6_and_9, Province_State == "North Carolina")
extp_6 <- subset(only_6_and_9, Province_State == "Oregon")
extp_7 <- subset(only_6_and_9, Province_State == "Arkansas")
extp_8 <- subset(only_6_and_9, Province_State == "Michigan")
extp_9 <- subset(only_6_and_9, Province_State == "Arizona")
extp_10 <- subset(only_6_and_9, Province_State == "South Carolina")

top_ten_perc_increase <- rbind(extp_1, extp_2, extp_3, extp_4, extp_5, extp_6, extp_7, extp_8, extp_9, extp_10)
```

```{r}
#make bar chart
#Modify: object dates and variable dates

three_day_perc_increase_6_6_to_6_9_bar <- ggplot(top_ten_perc_increase, aes(x = reorder(Province_State, -percent_increase), percent_increase)) + geom_bar(aes(fill = reorder(Province_State, -percent_increase)), stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust = 1),
                                                                                                   legend.position = "none",                                                                        axis.text=element_text(size=12),                                                                 axis.title.y = element_text(size = 12),
  panel.border = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  axis.line = element_line(colour = "black"),
  panel.background = element_blank()) + xlab("") + ylab("Percent Increase") + ggtitle("COVID-19: Top Ten Percent Increase by State From 6/6/2020-6/9/2020") +
  
   geom_text(aes(label = round(percent_increase, 2)), size = 4, position = position_stack(vjust = 0.8))

three_day_perc_increase_6_6_to_6_9_bar
```

```{r}
ggsave(filename = "../bar_charts/three_day_perc_increase_6_6_to_6_9_bar.png", plot = three_day_perc_increase_6_6_to_6_9_bar)
```

## 6/7/20-6/10/20


```{r}
#To determine percent increase from prior day, include only last two observations
#MODIFY: object dates and variable dates.

only_7_and_10 <- subset(covid_master, select = c(Province_State, cases_6_7, cases_6_10, fips, total_pop))
```


```{r}
#add percent increase
#MODIFY: object dates and variable dates.

only_7_and_10 <- only_7_and_10 %>% dplyr::mutate(percent_increase = (cases_6_10 - cases_6_7) / cases_6_7 * 100)
```

```{r}
#make heatmap of percent increase

p_increase_cases_7_to_10 <- plot_usmap(data = only_7_and_10, values = "percent_increase", color = "black") + 
  
  scale_fill_continuous(low = "white", high = "red", name = "Percent Increase", label = scales::comma) + theme(legend.position = "right", plot.title = element_text(color = "black", size = 15, face = "bold"), plot.subtitle = element_text(color = "black", size = 10, face = "italic")) + labs(title = "Percent Increase of Confirmed COVID-19 Cases by State", subtitle = "From: 6/7/2020-6/10/2020")

p_increase_cases_7_to_10
```

```{r}
ggsave(filename = "../heat_maps/p_increase_cases_7_to_10.png", plot = p_increase_cases_7_to_10)
```


```{r}
#Take a look at the top 10 percent increases
#MODIFY: cases variable for new date
tail(sort(only_7_and_10$percent_increase ),10)
```

```{r}
#subset top 10 cases
#subset top 10 100K
#MODIFY: must search ten above individually (subset does not allow to select by these values for some reason...) and past the states in the code below.Also modify variable and object date names.

extp_1 <- subset(only_7_and_10, Province_State == "California")
extp_2 <- subset(only_7_and_10, Province_State == "Mississippi")
extp_3 <- subset(only_7_and_10, Province_State == "Texas")
extp_4 <- subset(only_7_and_10, Province_State == "Alabama")
extp_5 <- subset(only_7_and_10, Province_State == "North Carolina")
extp_6 <- subset(only_7_and_10, Province_State == "Oregon")
extp_7 <- subset(only_7_and_10, Province_State == "Alaska")
extp_8 <- subset(only_7_and_10, Province_State == "Arkansas")
extp_9 <- subset(only_7_and_10, Province_State == "South Carolina")
extp_10 <- subset(only_7_and_10, Province_State == "Arizona")

top_ten_perc_increase <- rbind(extp_1, extp_2, extp_3, extp_4, extp_5, extp_6, extp_7, extp_8, extp_9, extp_10)
```

```{r}
#make bar chart
#Modify: object dates and variable dates

three_day_perc_increase_6_7_to_6_10_bar <- ggplot(top_ten_perc_increase, aes(x = reorder(Province_State, -percent_increase), percent_increase)) + geom_bar(aes(fill = reorder(Province_State, -percent_increase)), stat = "identity") + theme(axis.text.x = element_text(angle = 45, hjust = 1),
                                                                                                   legend.position = "none",                                                                        axis.text=element_text(size=12),                                                                 axis.title.y = element_text(size = 12),
  panel.border = element_blank(),
  panel.grid.major = element_blank(),
  panel.grid.minor = element_blank(),
  axis.line = element_line(colour = "black"),
  panel.background = element_blank()) + xlab("") + ylab("Percent Increase") + ggtitle("COVID-19: Top Ten Percent Increase by State From 6/7/2020-6/10/2020") +
  
   geom_text(aes(label = round(percent_increase, 2)), size = 4, position = position_stack(vjust = 0.8))

three_day_perc_increase_6_7_to_6_10_bar
```

```{r}
ggsave(filename = "../bar_charts/three_day_perc_increase_6_7_to_6_10_bar.png", plot = three_day_perc_increase_6_7_to_6_10_bar)
```



